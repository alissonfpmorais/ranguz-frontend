webpackJsonp([1],{"7zck":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i,a,s,o=n("7+uW"),l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",[n("v-navigation-drawer",{attrs:{persistent:"","mini-variant":t.miniVariant,clipped:t.clipped,"disable-resize-watcher":"",temporary:"",fixed:"",app:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[n("v-list",t._l(t.items,function(e,r){return n("v-list-tile",{key:r,attrs:{value:"true",to:e.route}},[n("v-list-tile-action",[n("v-icon",{domProps:{innerHTML:t._s(e.icon)}})],1),t._v(" "),n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.title))])],1)],1)}))],1),t._v(" "),n("v-toolbar",{attrs:{app:"","clipped-left":t.clipped}},[n("v-toolbar-side-icon",{on:{click:function(e){e.stopPropagation(),t.drawer=!t.drawer}}}),t._v(" "),n("v-toolbar-title",[t._v(t._s(t.title))]),t._v(" "),n("v-spacer")],1),t._v(" "),n("v-content",[n("router-view")],1)],1)},staticRenderFns:[]},c=n("VU/8")({name:"App",data:function(){return{clipped:!1,drawer:!1,fixed:!1,items:[{icon:"shopping_basket",title:"Pedidos",route:"/"},{icon:"supervisor_account",title:"Administrador",route:"/admin/login"},{icon:"person",title:"Cliente",route:"/client/login"}],miniVariant:!1,title:"Ranguz"}}},l,!1,null,null,null).exports,u=n("/ocq"),d=n("Xxa5"),p=n.n(d),v=n("exGp"),f=n.n(v),g=n("ryRw"),m=n.n(g),_=n("mtWM"),x=n.n(_),b=(r=f()(p.a.mark(function t(e){var n,r;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(n=F()).data=e,t.next=4,R(n);case 4:return r=t.sent,t.abrupt("return",r.data);case 6:case"end":return t.stop()}},t,this)})),function(t){return r.apply(this,arguments)}),h=(i=f()(p.a.mark(function t(e){var n,r;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(n=L()).data=e,t.next=4,R(n);case 4:return r=t.sent,t.abrupt("return",r.data);case 6:case"end":return t.stop()}},t,this)})),function(t){return i.apply(this,arguments)}),y=(a=f()(p.a.mark(function t(){var e;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R(T());case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}},t,this)})),function(){return a.apply(this,arguments)}),w=(s=f()(p.a.mark(function t(){var e;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R(C());case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}},t,this)})),function(){return s.apply(this,arguments)}),R=x.a.create({baseURL:"http://localhost:3000/api"}),k=function(t,e){return{method:t,url:e}},F=function(){return k("post","/clients")},L=function(){return k("post","/clients/auth")},T=function(){return k("get","/orders")},C=function(){return k("get","/products")},$={name:"Main",data:function(){return{orders:[],lastSync:"Dados indisponíveis!"}},methods:{loadOrders:function(){var t=this;return f()(p.a.mark(function e(){var n;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y();case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}},e,t)}))()},formatDate:function(t){var e=function(t){return t<10?"0"+t:""+t},n=t.getFullYear(),r=["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"][t.getMonth()];return e(t.getDate())+" de "+r+" de "+n+" às "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())}},created:function(){var t=this,e=m.a.fromPromise(this.loadOrders()),n=m.a.periodic(3e4).map(function(){return m.a.fromPromise(t.loadOrders())}).flatten();m.a.merge(e,n).map(function(t){return t.filter(function(t){return!t.done})}).subscribe({next:function(e){var n=e.map(function(t){return t.action="person",t.active=!1,t});t.orders=n.map(function(e){return t.orders.forEach(function(t){e.id===t.id&&(e.active=t.active)}),e}).sort(function(t,e){return new Date(t.date)-new Date(e.date)}),t.lastSync=t.formatDate(new Date(Date.now()))}})}},P={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-layout",{attrs:{column:""}},[n("v-list",[n("v-subheader",{staticClass:"success white--text"},[t._v("Última Sincronização: "+t._s(t.lastSync))]),t._v(" "),t._l(t.orders,function(e){return n("v-list-group",{key:e.id,attrs:{"prepend-icon":e.action,"no-action":""},model:{value:e.active,callback:function(n){t.$set(e,"active",n)},expression:"order.active"}},[n("v-list-tile",{staticClass:"py-3",attrs:{slot:"activator"},slot:"activator"},[n("v-list-tile-content",[n("v-list-tile-title",[t._v("Matrícula: "+t._s(e.client.register))]),t._v(" "),n("v-list-tile-sub-title",[t._v("Pedido: "+t._s(e.id))])],1)],1),t._v(" "),t._l(e.cart,function(e){return n("v-list-tile",{key:e.name},[n("v-list-tile-action",[t._v(t._s(e.quantity)+"x")]),t._v(" "),n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.name))])],1)],1)})],2)})],2)],1)],1)},staticRenderFns:[]},q=n("VU/8")($,P,!1,null,null,null).exports,S=n("mvHQ"),j=n.n(S),D={nameField:[function(t){return/^[a-zA-Z]{3,}$/.test(t)||"O nome deve conter pelo menos 3 letras"}],cpfField:[function(t){return/^[0-9]{3}\.?[0-9]{3}\.?[0-9]{3}-?[0-9]{2}$/.test(t)||"CPF Inválido"}],registerField:[function(t){return/^\d{4}$/.test(t)||"A matrícula deve conter 4 dígitos"}],passField:[function(t){return/^\d{4,}$/.test(t)||"A senha deve conter pelo menos 4 dígitos"}]},M={name:"Login",data:function(){return{cpf:"",password:"",passType:!0,isLogging:!1,registerRoute:"/client/register",shoppingRoute:"/client/shopping",validationRules:D}},methods:{attemptToLogin:function(){var t=this;return f()(p.a.mark(function e(){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.$refs.loginForm.validate()&&(t.isLogging=!0,n={cpf:t.cpf,password:t.password},m.a.fromPromise(h(n)).subscribe({next:function(e){t.isLogging=!1,console.log("auth"),e.token&&(localStorage.setItem("credentials",j()(e)),t.$router.push(t.shoppingRoute))},error:function(){t.isLogging=!1,console.log("error")}}));case 1:case"end":return e.stop()}},e,t)}))()}},mounted:function(){localStorage.getItem("credentials")&&this.$router.push(this.shoppingRoute)}},V={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{"align-center":"","justify-center":""}},[n("v-flex",{attrs:{xs12:"",sm9:"",md9:"",lg5:"",xl5:"","text-xs-center":"","text-sm-center":"","text-md-center":"","text-lg-center":"","text-xl-center":""}},[n("v-form",{ref:"loginForm",staticClass:"pa-4 elevation-4 round-corner"},[n("v-text-field",{attrs:{rules:t.validationRules.cpfField,counter:11,disabled:t.isLogging,label:"CPF","prepend-icon":"credit_card",required:""},model:{value:t.cpf,callback:function(e){t.cpf=e},expression:"cpf"}}),t._v(" "),n("v-text-field",{attrs:{"append-icon":t.passType?"visibility":"visibility_off","append-icon-cb":function(){return t.passType=!t.passType},type:t.passType?"password":"text",rules:t.validationRules.passField,disabled:t.isLogging,label:"Senha","prepend-icon":"lock",required:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),n("v-layout",{staticClass:"mt-4",attrs:{row:""}},[n("v-btn",{attrs:{to:t.registerRoute,disabled:t.isLogging,flat:""}},[t._v("Cadastrar")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"primary",loading:t.isLogging},on:{click:t.attemptToLogin}},[t._v("Login")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var z={name:"Register",data:function(){return{name:"",cpf:"",register:"",password:"",passType:!0,isRegistering:!1,dialog:{status:!1,title:"",message:"",button:"",color:"",route:""},loginRoute:"/client/login",registerRoute:"/client/register",validationRules:D}},methods:{attemptToRegister:function(){var t=this;return f()(p.a.mark(function e(){var n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.$refs.registerForm.validate()&&(t.isRegistering=!0,n={name:t.name,cpf:t.cpf,register:t.register,password:t.password},m.a.fromPromise(b(n)).map(function(t){return t.cpf===n.cpf}).subscribe({next:function(e){e?(t.dialog.title="Cadastrado com sucesso",t.dialog.message="Dirija-se ao refeitório com sua carterinha estudantil e finalize seu cadastro!",t.dialog.button="Ir ao Login",t.dialog.color="green darken-1",t.dialog.route=t.loginRoute):(t.dialog.title="Problemas no cadastro",t.dialog.message="Tente novamente mais tarde!",t.dialog.button="Fechar",t.dialog.color="red darken-1",t.dialog.route=t.registerRoute),t.isRegistering=!1,t.dialog.status=!0}}));case 1:case"end":return e.stop()}},e,t)}))()}}},A={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","fill-height":""}},[n("v-layout",{attrs:{"align-center":"","justify-center":""}},[n("v-flex",{attrs:{xs12:"",sm9:"",md9:"",lg5:"",xl5:"","text-xs-center":"","text-sm-center":"","text-md-center":"","text-lg-center":"","text-xl-center":""}},[n("v-form",{ref:"registerForm",staticClass:"pa-4 elevation-4 round-corner"},[n("v-text-field",{attrs:{rules:t.validationRules.nameField,disabled:t.isRegistering,label:"Nome","prepend-icon":"person",required:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),t._v(" "),n("v-text-field",{attrs:{rules:t.validationRules.cpfField,counter:11,disabled:t.isRegistering,label:"CPF","prepend-icon":"credit_card",required:""},model:{value:t.cpf,callback:function(e){t.cpf=e},expression:"cpf"}}),t._v(" "),n("v-text-field",{attrs:{rules:t.validationRules.registerField,counter:4,disabled:t.isRegistering,label:"Matrícula","prepend-icon":"money",required:""},model:{value:t.register,callback:function(e){t.register=e},expression:"register"}}),t._v(" "),n("v-text-field",{attrs:{"append-icon":t.passType?"visibility":"visibility_off","append-icon-cb":function(){return t.passType=!t.passType},type:t.passType?"password":"text",rules:t.validationRules.passField,disabled:t.isRegistering,label:"Senha","prepend-icon":"lock",required:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),t._v(" "),n("v-layout",{staticClass:"mt-4",attrs:{row:""}},[n("v-btn",{attrs:{to:t.loginRoute,disabled:t.isRegistering,flat:""}},[t._v("Voltar")]),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{color:"primary",loading:t.isRegistering},on:{click:t.attemptToRegister}},[t._v("Cadastrar")])],1),t._v(" "),n("v-dialog",{attrs:{persistent:"","max-width":"320"},model:{value:t.dialog.status,callback:function(e){t.$set(t.dialog,"status",e)},expression:"dialog.status"}},[n("v-card",[n("v-card-title",{staticClass:"headline"},[t._v(t._s(t.dialog.title))]),t._v(" "),n("v-card-text",[t._v(t._s(t.dialog.message))]),t._v(" "),n("v-card-actions",[n("v-spacer"),t._v(" "),n("v-btn",{attrs:{to:t.dialog.route,color:t.dialog.color,flat:"flat"},nativeOn:{click:function(e){t.dialog.status=!1}}},[t._v("\n                "+t._s(t.dialog.button)+"\n              ")])],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var E={name:"Shopping",data:function(){return{products:[]}},methods:{updateQuantity:function(t,e,n){var r=e+n;this.products[t].quantity=r>0?r:0}},created:function(){var t=this;m.a.fromPromise(w()).map(function(t){return t.map(function(t){return t.price=String(parseFloat(t.value).toFixed(2)).replace(".",","),t.quantity=0,delete t.value,t})}).subscribe({next:function(e){t.products=e}})}},H={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-layout",{attrs:{column:""}},[n("v-list",t._l(t.products,function(e,r){return n("v-list-tile",{key:e.name,staticClass:"py-3"},[n("v-list-tile-content",[n("v-list-tile-title",[t._v(t._s(e.name))]),t._v(" "),n("v-list-tile-sub-title",[t._v("R$ "+t._s(e.price))])],1),t._v(" "),n("v-list-tile-action",[n("v-layout",{attrs:{row:"","align-center":""}},[n("v-btn",{attrs:{outline:"",icon:"",color:"primary"},on:{click:function(n){t.updateQuantity(r,e.quantity,-1)}}},[n("v-icon",[t._v("exposure_neg_1")])],1),t._v(" "),n("p",{staticClass:"ma-0 px-5 text-xs-center text-sm-center text-md-center text-lg-center text-xl-center",attrs:{disabled:""}},[t._v(" "+t._s(e.quantity)+"\n            ")]),t._v(" "),n("v-btn",{attrs:{outline:"",icon:"",color:"primary"},on:{click:function(n){t.updateQuantity(r,e.quantity,1)}}},[n("v-icon",[t._v("exposure_plus_1")])],1)],1)],1)],1)}))],1)],1)},staticRenderFns:[]},O=[{path:"/",name:"Main",component:q},{path:"/client/login",name:"Login",component:n("VU/8")(M,V,!1,function(t){n("XeLj")},"data-v-79e1b9da",null).exports},{path:"/client/register",name:"Register",component:n("VU/8")(z,A,!1,function(t){n("RoHy")},"data-v-065e4666",null).exports},{path:"/client/shopping",name:"Shopping",component:n("VU/8")(E,H,!1,null,null,null).exports}];o.a.use(u.a);var U=new u.a({routes:O}),I=n("3EgV"),Q=n.n(I);n("7zck");o.a.use(Q.a,{}),o.a.config.productionTip=!1,new o.a({el:"#app",router:U,components:{App:c},template:"<App/>"})},RoHy:function(t,e){},XeLj:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.cf4534ac286ec7e1d5a1.js.map